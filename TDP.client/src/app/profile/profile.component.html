<!-- Profile Header -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header bg-info text-white">
        <h5 class="card-title mb-0">
          <i class="fas fa-user-circle me-2"></i>{{ 'profile.userProfile' | translate }}
          <div class="float-end">
            <button type="button" class="btn btn-outline-light btn-sm me-2" (click)="goToHome()" [title]="'profile.backToHome' | translate">
              <i class="fas fa-home me-1"></i>{{ 'nav.home' | translate }}
            </button>
            <button type="button" class="btn btn-outline-danger btn-sm" (click)="logout()" [title]="'nav.logout' | translate">
              <i class="fas fa-sign-out-alt me-1"></i>{{ 'nav.logout' | translate }}
            </button>
          </div>
        </h5>
      </div>
      <div class="card-body">
        <!-- Loading State -->
        <div *ngIf="isLoading" class="text-center py-4">
          <div class="spinner-border text-info" role="status">
            <span class="visually-hidden">{{ 'ui.loading' | translate }}</span>
          </div>
          <p class="mt-2 text-muted">{{ 'profile.loadingProfile' | translate }}</p>
        </div>

        <!-- Error State -->
        <div *ngIf="errorMessage && !isLoading" class="alert alert-danger">
          <i class="fas fa-exclamation-triangle me-2"></i>{{ errorMessage }}
          <button type="button" class="btn btn-outline-danger btn-sm ms-3" (click)="loadProfile()">
            <i class="fas fa-redo me-1"></i>{{ 'profile.retry' | translate }}
          </button>
        </div>

        <!-- Profile Content -->
        <div *ngIf="!isLoading && !errorMessage && currentUser" class="row">
          <!-- Profile Picture Section -->
          <div class="col-md-4 text-center">
            <div class="profile-picture mb-4">
              <div class="avatar-placeholder">
                <i class="fas fa-user-circle"></i>
              </div>
              <h4 class="mt-3 text-primary">{{ currentUser.name || currentUser.username || 'User' }}</h4>
              <p class="text-muted">{{ currentUser.email }}</p>
            </div>
          </div>

          <!-- Profile Details Section -->
          <div class="col-md-8">
            <div class="profile-details">
              <h5 class="border-bottom pb-2 mb-3">
                <i class="fas fa-info-circle me-2 text-info"></i>{{ 'profile.personalInformation' | translate }}
              </h5>
              
              <div class="row">
                <div class="col-md-6">
                  <div class="detail-item mb-3">
                    <label class="form-label fw-bold text-muted">
                      <i class="fas fa-user me-2 text-primary"></i>{{ 'profile.fullName' | translate }}
                    </label>
                    <p class="form-control-plaintext">{{ currentUser.name || ('profile.notSpecified' | translate) }}</p>
                  </div>
                </div>
                
                <div class="col-md-6">
                  <div class="detail-item mb-3">
                    <label class="form-label fw-bold text-muted">
                      <i class="fas fa-at me-2 text-primary"></i>{{ 'profile.username' | translate }}
                    </label>
                    <p class="form-control-plaintext">{{ currentUser.username || ('profile.notSpecified' | translate) }}</p>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="detail-item mb-3">
                    <label class="form-label fw-bold text-muted">
                      <i class="fas fa-envelope me-2 text-primary"></i>{{ 'profile.emailAddress' | translate }}
                    </label>
                    <p class="form-control-plaintext">{{ currentUser.email || ('profile.notSpecified' | translate) }}</p>
                  </div>
                </div>
                
                <div class="col-md-6">
                  <div class="detail-item mb-3">
                    <label class="form-label fw-bold text-muted">
                      <i class="fas fa-calendar me-2 text-primary"></i>{{ 'profile.birthDate' | translate }}
                    </label>
                    <p class="form-control-plaintext">{{ formatDate(currentUser.birthDate) }}</p>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="detail-item mb-3">
                    <label class="form-label fw-bold text-muted">
                      <i class="fas fa-building me-2 text-primary"></i>{{ 'profile.department' | translate }}
                    </label>
                    <p class="form-control-plaintext">{{ getDepartmentName(currentUser.departmentID) }}</p>
                  </div>
                </div>
                
                <div class="col-md-6">
                  <div class="detail-item mb-3">
                    <label class="form-label fw-bold text-muted">
                      <i class="fas fa-id-badge me-2 text-primary"></i>{{ 'profile.userId' | translate }}
                    </label>
                    <p class="form-control-plaintext">{{ currentUser.id || ('profile.notSpecified' | translate) }}</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Account Status Section -->
                         <div class="profile-status mt-4">
               <h5 class="border-bottom pb-2 mb-3">
                 <i class="fas fa-shield-alt me-2 text-success"></i>{{ 'profile.accountStatus' | translate }}
               </h5>
               
               <div class="row">
                 <div class="col-md-6">
                   <div class="status-item">
                     <span class="badge bg-success me-2">
                       <i class="fas fa-check-circle me-1"></i>{{ 'profile.active' | translate }}
                     </span>
                     <small class="text-muted">{{ 'profile.accountActive' | translate }}</small>
                   </div>
                 </div>
                 
                 <div class="col-md-6">
                   <div class="status-item">
                     <span class="badge bg-info me-2">
                       <i class="fas fa-clock me-1"></i>{{ 'profile.loggedIn' | translate }}
                     </span>
                     <small class="text-muted">{{ 'profile.currentlyLoggedIn' | translate }}</small>
                   </div>
                 </div>
               </div>
             </div>

             <!-- Account Actions Section -->
             <div class="profile-actions mt-4">
               <h5 class="border-bottom pb-2 mb-3">
                 <i class="fas fa-cogs me-2 text-warning"></i>{{ 'profile.accountActions' | translate }}
               </h5>
               
               <div class="row">
                 <div class="col-md-6">
                   <button type="button" class="btn btn-warning w-100" (click)="goToChangePassword()">
                     <i class="fas fa-key me-2"></i>{{ 'profile.changePassword' | translate }}
                   </button>
                 </div>
                 <div class="col-md-6">
                   <button type="button" class="btn btn-outline-secondary w-100" (click)="goToHome()">
                     <i class="fas fa-home me-2"></i>{{ 'profile.goToHome' | translate }}
                   </button>
                 </div>
               </div>
             </div>
          </div>
        </div>

        <!-- No User Data State -->
        <div *ngIf="!isLoading && !errorMessage && !currentUser" class="text-center py-4">
          <i class="fas fa-user-slash text-muted" style="font-size: 3rem;"></i>
          <h5 class="text-muted mt-3">{{ 'profile.noProfileData' | translate }}</h5>
          <p class="text-muted">{{ 'profile.unableToLoad' | translate }}</p>
          <button type="button" class="btn btn-primary" (click)="loadProfile()">
            <i class="fas fa-redo me-1"></i>{{ 'profile.tryAgain' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
